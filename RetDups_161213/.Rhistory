library("ape", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
library("phangorn", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
?F18
??F18
?dist.dna
library("ape", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
install.packages("phangorn")
library("phangorn", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
help parsimony
-help parsimony
library parsimony
? parsimony
? morphological
??morphological
??binary
library("ape", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
library("phangorn", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
? morphological
??morphological
?parsimony
??binary
??phangorn-packa
?phangorn
library(help=phangorn)
library(help = phangorn)
library(help=phyDat)
?phyDat''
? phyDat
library("ape", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
library("geiger", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
library("TreeSim", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
?sim.bd.taxa.age
t1obj=sim.bd.taxa.age(100,1,spec_rate=1,0,1,1,mrca=TRUE)
t1obj=sim.bd.taxa.age(100,1,1,0,1,1,mrca=TRUE)
t1 = t1obj[1]
plot.phylo (t1)
plit t1
plot t1
plot (t1)
plot t1obj
rm t1
clear t1
t1 = t1obj[[1]]
plot.phylo (t1)
x <- sim.char(t1, matrix(10) )
y <- sim.char(t1, matrix(10) )
plot (x,y)
fit1 = lm(y~x)
summary(fit1)
lines(x,fit1$coefficients[1] + x*fit1$coefficients[2])
x_ic <- pic(x, t1)
y_ic <- pic(y, t1)
plot (x_ic,y_ic)
fit1_1 = lm(y_ic-x_ic)
fit1_1 = 1m(y_ic-x_ic)
fit11 = lm(y_ic~x_ic)
summary(fit1)
lines(x_ic,fit11$coefficients[1] + x_ic*fit11$coefficients[2])
fitpic = lm(y_ic ~ x_ic -1)
lines(x_ic,fit11$coefficients[1] + x_ic*fit11$coefficients[2])
summary fitpic
summary (fitpic)
t2obj=sim.bd.taxa.age(100,1,50,0,1,1,mrca=TRUE)
t2 = t2obj[[1]]
x2 <- sim.char(t1, matrix(10) )
x2 <- sim.char(t2, matrix(10) )
y2 <- sim.char(t2, matrix(10) )
plot (x1,y1)
plot (x2,y2)
fit2 = lm(y2~x2)
summary(fit2)
lines(x2,fit2$coefficients[1] + x2*fit1$coefficients[2])
x_ic2 <- pic(x2, t2)
y_ic2 <- pic(y2, t2)
fitpic2 = lm(y_ic2 ~ x_ic2 -1)
summary (fitpic2)
plot (x_ic2,y_ic2)
lines(x_ic,fit2$coefficients[1] + x_ic2*fit2$coefficients[2])
lines(x_ic2,fit2$coefficients[1] + x_ic2*fit2$coefficients[2])
plot (x_ic2,y_ic2)
lines(x_ic2,fit2$coefficients[1] + x_ic2*fit2$coefficients[2])
plot (x_ic2,y_ic2)
lines(x_ic2,fit2$coefficients[1] + x_ic2*fitpic2$coefficients[2])
plot(fitpic)
plot(fitpic2)
summary (fitpic2)
plot(x_ic2,y_ic2)
fitpic2 = lm(y_ic2 ~ x_ic2 -1)
lines(x_ic2,fit11$coefficients[1] + x_ic2*fitpic2$coefficients[2])
lines(x_ic2,fit1$coefficients[1] + x_ic2*fitpic2$coefficients[2])
plot(x_ic2,y_ic2)
fitpic2 = lm(y_ic2 ~ x_ic2 -1)
lines(x_ic2,fitpic2$coefficients[1] + x_ic2*fitpic2$coefficients[2])
lines(x_ic2,fit2$coefficients[1] + x_ic2*fit2$coefficients[2])
lines(x_ic,fit11$coefficients[1] + x_ic*fit11$coefficients[2])
plot (x_ic2,y_IC2)
plot (x_ic2,y_ic2)
lines(x_ic,fit11$coefficients[1] + x_ic*fit11$coefficients[2])
plot.phylo (t2)
t1obj=sim.bd.taxa.age(100,1,100,0,1,1,mrca=TRUE)
t1obj=sim.bd.taxa.age(100,1,1,0,1,1,mrca=TRUE)
t3obj=sim.bd.taxa.age(100,1,100,0,1,1,mrca=TRUE)
t3 = t3obj[[1]]
x3 <- sim.char(t3, matrix(10) )
y3 <- sim.char(t3, matrix(10) )
plot(x3,y3)
fit3 = lm(y3~x3)
summary(fit3)
lines(x3,fit3$coefficients[1] + x3*fit3$coefficients[2])
x_ic3 <- pic(x3, t3)
y_ic3 <- pic(y3, t3)
plot(x_ic3,y_ic3)
fitpic3 = lm(y_ic3 ~ x_ic3 -1)
summary (fitpic3)
plot.phylo (t3)
library("ape", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
?ace
install.packages("evobiR")
library("evobiR")
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/concat_align.fa")
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/concat_align.fa", sig.test = "J", block.size = 10000, replicate = 100)
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/cat_alignment.fa", sig.test = "J", block.size = 10000, replicate = 100)
> install.packages("evobiR")
install.packages("evobiR")
library("evobiR")
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/singlex3_cat_align.fa", sig.test = "J", block.size = 10000, replicate = 100)
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/chlorotop_cat_align.fa", sig.test = "J", block.size = 10000, replicate = 100)
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/Boecheradopsis_cat_align.fa", sig.test = "J", block.size = 10000, replicate = 100)
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/nuclear_topolgy_catalign.fa", sig.test = "J", block.size = 10000, replicate = 100)
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/Chromosomes/scaff1_catalign.fa", sig.test = "J", block.size = 10000, replicate = 100)
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/Chromosomes/scaff2_catalign.fa", sig.test = "J", block.size = 10000, replicate = 100)
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/Chromosomes/scaff3_catalign.fa", sig.test = "J", block.size = 10000, replicate = 100)
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/Chromosomes/scaff4_catalign.fa", sig.test = "J", block.size = 10000, replicate = 100)
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/Chromosomes/scaff5_catalign.fa", sig.test = "J", block.size = 10000, replicate = 100)
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/Chromosomes/scaff6_catalign.fa", sig.test = "J", block.size = 10000, replicate = 100)
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/Chromosomes/scaff7_catalign.fa", sig.test = "J", block.size = 10000, replicate = 100)
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/Chromosomes/scaff8_catalign.fa", sig.test = "J", block.size = 10000, replicate = 100)
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/singlex3_cat_align.fa", sig.test = "J", block.size = 100000, replicate = 100)
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/singlex3_cat_align.fa", sig.test = "J", block.size = 100000, replicate = 500)
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/singlex3_cat_align.fa", sig.test = "J", block.size = 50000, replicate = 500)
> install.packages("evobiR")
install.packages("evobiR")
library("evobiR")
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/practice/catfile160414")
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/practice/practice_1.fasta")
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_03_30_Dstat/practice/practice_2.fasta")
install.packages("evobiR")
library("evobiR")
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_04_14_Dstat_syntenicblocks/concat_alignments/Chrom1_cat_align.fasta")
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_04_14_Dstat_syntenicblocks/concat_alignments/Chrom1_cat_align.fasta")
install.packages("evobiR")
library("evobiR")
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_04_14_Dstat_syntenicblocks/concat_alignments/Chrom1_concat_notfull.fasta")
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_04_14_Dstat_syntenicblocks/concat_alignments/Chrom1_concat_notfull_rearrange.fasta")
install.packages("evobiR")
library("evobiR")
CalcPopD
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test.fasta")
CalcPopD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test.fasta")
CalcPopD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test1.fasta")
CalcPopD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test1.fasta")
CalcPopD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test1.fasta")
CalcPopD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test1.fasta")
CalcPopD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test3.fasta")
CalcPopD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test3.fasta")
CalcPopD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test3.fasta")
CalcPopD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test3.fasta")
CalcPopD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test3.fasta")
CalcPopD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test3.fasta")
CalcPopD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test3.fasta")
CalcPopD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test3.fasta", sig.test = "B", replicate = 100)
CalcPopD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test3.fasta", sig.test = "B", replicate = 100)
CalcPopD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test3.fasta")
CalcD("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_05_09_fullalignconcat/Test3.fasta")
packages(evobiR)
package(evobiR)
citation(evobiR)
install.packages("evobiR", repos='http://cran.itam.mx/')
install.packages("evobiR")
library("evobiR")
citation(evobiR)
citation("evobiR")
citation
citation(package = "base", lib.loc = NULL, auto = NULL)
library(ape)
library(phytools)
library(geiger)
library(lattice)
library(gtable)
install.packages("gridExtra")
library(gridExtra)
setwd("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_10_24_topology_analysis/RetDups_161213")
install.packages("ape")
library(ape)
library(phytools)
library(geiger)
tree<-read.tree("RAxML_bipartitions.108.fasta.phy")
?root
treeSlice<-function(tree,slice){
if(class(tree)!="phylo") stop("tree should be object of class 'phylo.'")
tree<-reorder(tree) # reorder cladewise
# compute node heights
root<-length(tree$tip)+1
node.height<-matrix(NA,nrow(tree$edge),2)
for(i in 1:nrow(tree$edge)){
if(tree$edge[i,1]==root){
node.height[i,1]<-0.0
node.height[i,2]<-tree$edge.length[i]
} else {
node.height[i,1]<-node.height[match(tree$edge[i,1],tree$edge[,2]),2]
node.height[i,2]<-node.height[i,1]+tree$edge.length[i]
}
}
edges<-which(node.height[,2]>slice&node.height[,1]<slice)
nodes<-tree$edge[edges,2]; nodes<-nodes[nodes>length(tree$tip)]
trees<-list(); class(trees)<-"multiPhylo"
for(i in 1:length(nodes)){
trees[[i]]<-extract.clade(tree,node=nodes[i])
trees[[i]]$root.edge<-node.height[which(tree$edge[,2]==nodes[i]),2]-slice
}
return(trees)
}
trees<-treeSlice(tree, 0.6)
trees<-treeSlice(tree, 5)
?reorder.phylo
tree<-reorder.phylo(tree, "cladewise")
trees<-treeSlice(tree, 5)
trees<-treeSlice(tree, 10)
trees<-treeSlice(tree, 20)
Ntip(phy=tree)
plot(tree)
root_tree<-midpoint.root(tree)
tree<-read.tree("RAxML_bipartitions.108.fasta.phy")
root_tree<-midpoint.root(tree)
midpoint.root(tree)
tree$edge
tree$edge.length
tree<-read.tree(
text="((Csativa__XP_010457102:0.01518881265333598893,(Csativa__XP_010480051:0.00662865210348756104,Csativa__XP_010474770:0.00671291887992642774)52:0.00324457624170141744)100:0.02191034610995688109,((Crub__Carubv10010070m:0.00000153396898798239,Cgrand__Cagra.1968s0103:0.00395412686650943156)100:0.03470315157896354530,(Bstri__Bostr.5325s0084:0.03216375026092795769,(Alyr__16054647:0.02326242938724031040,Athal__AT1G01630:0.02159315289028859372)100:0.04204974080296691036)39:0.00542206353861695092)50:0.00982388583721963138,Esal__Thhalv10008535m:0.13360687503277937638);
")
midpoint.root(tree)
root_tree<-midpoint.root(tree)
plot(root_tree)
tree<-read.tree("RAxML_bipartitions.108.fasta.phy")
class(tree)
midpoint.root(tree)
tree<-reorder.phylo(tree, "cladewise")
midpoint.root(tree)
tree<-read.tree("RAxML_bipartitions.197.fasta.phy")
root_tree<-midpoint.root(tree)
midpoint.root
midpoint <- function(tree){
dm = cophenetic(tree)
tree = unroot(tree)
rn = max(tree$edge)+1
maxdm = max(dm)
ind = which(dm==maxdm,arr=TRUE)[1,]
tmproot = Ancestors(tree, ind[1], "parent")
tree = phangorn:::reroot(tree, tmproot)
edge = tree$edge
el = tree$edge.length
children = tree$edge[,2]
left = match(ind[1], children)
tmp = Ancestors(tree, ind[2], "all")
tmp= c(ind[2], tmp[-length(tmp)])
right = match(tmp, children)
if(el[left]>= (maxdm/2)){
edge = rbind(edge, c(rn, ind[1]))
edge[left,2] = rn
el[left] = el[left] - (maxdm/2)
el = c(el, maxdm/2)
}
else{
sel = cumsum(el[right])
i = which(sel>(maxdm/2))[1]
edge = rbind(edge, c(rn, tmp[i]))
edge[right[i],2] = rn
eltmp = sel[i] - (maxdm/2)
# el = c(el, sel[i] - (maxdm/2))
el = c(el, el[right[i]] - eltmp)
el[right[i]] = eltmp
}
tree$edge.length = el
tree$edge=edge
tree$Nnode = tree$Nnode+1
phangorn:::reorderPruning(phangorn:::reroot(tree, rn))
}
midpoint(tree)
library(phangorn)
root_tree<-midpoint.root(tree)
midpoint(tree)
plot(tree)
root_tree<-midpoint(tree)
plot(root_tree)
trees<-treeSlice(root_tree, 1)
trees<-treeSlice(root_tree, 1, TRUE)
trees<-treeSlice(root_tree, 1, FALSE)
class(trees)
trees
?extract.clade
root_tree$node.label
plot(root_tree)
nodelabels(root_tree$node.label)
#obtained from http://grokbase.com/t/r/r-sig-phylo/109268tgx8/midpoint-rooting
plot(root_tree)
nodelabels(tree$node.label)
root_tree
nodes(root_tree)
plot.phylo(root_tree, show.node.label=TRUE)
?treeSlice
rm treeSlice
rm(treeSlice)
treeSlice(root_tree, 0, trivial=FALSE, prompt=FALSE)
install.packages("phytools")
install.packages("phytools")
library(phytools)
library(ape)
library(geiger)
library(phangorn)
setwd("/Users/esforsythe/Documents/Beilstiein_lab_research/BIOINFORMATICS/Brassicaceae_Phylo/16_10_24_topology_analysis/RetDups_161213")
tree<-read.tree("RAxML_bipartitions.197.fasta.phy")
midpoint <- function(tree){
dm = cophenetic(tree)
tree = unroot(tree)
rn = max(tree$edge)+1
maxdm = max(dm)
ind = which(dm==maxdm,arr=TRUE)[1,]
tmproot = Ancestors(tree, ind[1], "parent")
tree = phangorn:::reroot(tree, tmproot)
edge = tree$edge
el = tree$edge.length
children = tree$edge[,2]
left = match(ind[1], children)
tmp = Ancestors(tree, ind[2], "all")
tmp= c(ind[2], tmp[-length(tmp)])
right = match(tmp, children)
if(el[left]>= (maxdm/2)){
edge = rbind(edge, c(rn, ind[1]))
edge[left,2] = rn
el[left] = el[left] - (maxdm/2)
el = c(el, maxdm/2)
}
else{
sel = cumsum(el[right])
i = which(sel>(maxdm/2))[1]
edge = rbind(edge, c(rn, tmp[i]))
edge[right[i],2] = rn
eltmp = sel[i] - (maxdm/2)
# el = c(el, sel[i] - (maxdm/2))
el = c(el, el[right[i]] - eltmp)
el[right[i]] = eltmp
}
tree$edge.length = el
tree$edge=edge
tree$Nnode = tree$Nnode+1
phangorn:::reorderPruning(phangorn:::reroot(tree, rn))
}
root_tree<-midpoint(tree)
treeSlice(root_tree, 0, trivial=FALSE, prompt=FALSE)
treeSlice
treeSlice(root_tree, 0, trivial=TRUE, prompt=FALSE)
if (!inherits(tree, "phylo"))
if (!inherits(tree, "phylo"))
stop("tree should be an object of class \"phylo\".")
treeSlice(root_tree, 0, trivial=TRUE, prompt=TRUE)
treeSlice(root_tree, 0, trivial=TRUE, prompt=TRUE)
trees
treeSlice(root_tree, 0.05, trivial=TRUE, prompt=FALSE)
treeSlice(root_tree, 0.01, trivial=TRUE, prompt=FALSE)
sliced_trees<-treeSlice(root_tree, 0.01, trivial=TRUE, prompt=FALSE)
class(sliced_trees)
plot(sliced_trees)
root_tree<-midpoint(tree)
plot(root_tree)
nodelabels(root_tree$node.label)
plot(root_tree)
nodelabels(tree$node.label)
plot(tree)
plot.phylo(tree, show.node.label=TRUE)
plot.phylo(root_tree, show.node.label=TRUE)
root_tree$node.label=tree$node.label
plot.phylo(root_tree, show.node.label=TRUE)
